
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Create Yii Extension by Example - EPrism - ifdattic</title>
  <meta name="author" content="Andrew Marcinkevičius">

  
  <meta name="description" content="This is the tutorial about how to make a simple Yii extension. It would be most useful to people who are just starting with Yii framework. The &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ifdattic.github.io/create-yii-extension-by-example-eprism">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="ifdattic" type="application/atom+xml">
  <script src="/js/modernizr-2.8.3-custom.min.js"></script>
  <script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./js/libs/jquery-2.1.3.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="https://plus.google.com/111660522645911622239/posts" rel="author">
<script src="//load.sumome.com/" data-sumo-site-id="c164debf0a268ada6ab9186c859e0f9e07ed6d194f1e9f7d9d80d283225e676e" async></script>

  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-48134144-1', 'ifdattic.com');
    ga('send', 'pageview');

    window.onscroll = function () {
        window.onscroll = null;
        ga('send', 'event', 'ga bounce scroll');
    }

  </script>


</head>

<body >
  <header role="banner">
    <div class="wrapper"><hgroup>
  <h1>
    <a href="/">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class="sitelogo" alt="ifdattic" />
    </a>
  </h1>
</hgroup>

<nav class="nav" data-state="closed">
  <a href="#" class="nav-reveal">
    <span></span>
    <span></span>
    <span></span>
  </a>
  <ul>
    <li><a href="/">Blog</a></li>
    <li><a href="/about">Portfolio</a></li>
    <li><a href="/about">About</a></li>
  </ul>
</nav>


</div>
  </header>
  <div id="main">
    <div id="content" class="wrapper">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Create Yii Extension by Example - EPrism</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-05T21:46:37+02:00" pubdate data-updated="true">March  5, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>This is the tutorial about how to make a simple <a href="http://www.yiiframework.com/">Yii</a> extension. It would be most useful to people who are just starting with Yii framework. The tutorial is step-by-step guide using an <a href="http://www.yiiframework.com/extension/eprism">EPrism</a> extension as a base. This would be really helpful if for example you found a nice JavaScript plugin and want to use it as a part of framework rather than just adding it statically in your application.</p>

<h2>1. Set up</h2>

<p>Everything needs to start from something, so do the following steps to have a base on which you can build your extension:</p>

<ul>
<li>Create a folder <code>EPrism</code> for extension</li>
<li>Create an extension file name <code>EPrism.php</code> inside the folder</li>
<li>Create a class <code>EPrism</code> which extends a framework class of <code>CWidget</code> in the <code>EPrism.php</code> file</li>
<li>Add <code>init()</code> and <code>run()</code> methods</li>
</ul>


<p><a href="http://www.yiiframework.com/doc/api/1.1/CWidget/"><code>CWidget</code> class</a> is a base class for widgets. You can think of a widget as a self-contained component that may generate presentation based on model data.</p>

<p>The <a href="http://www.yiiframework.com/doc/api/1.1/CWidget#init-detail"><code>init()</code> method</a> initializes the widget.</p>

<p>The <a href="http://www.yiiframework.com/doc/api/1.1/CWidget#run-detail"><code>run()</code> method</a> executes the widget.</p>

<h4>Step results</h4>

<p>By now your folder structure should be:</p>

<figure class='code'><figcaption><span>Folder structure after first step</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>EPrism/
</span><span class='line'>└── EPrism.php
</span></code></pre></td></tr></table></div></figure>


<p>The contents of <code>EPrism.php</code> file should be:</p>

<figure class='code'><figcaption><span>Extension contents after first step</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">EPrism</span> <span class="k">extends</span> <span class="nx">CWidget</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">init</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>2. Add extension assets</h2>

<p>To be able to use the extension <em>out of the box</em>, you need to add the assets for it. Start by creating a folder <code>assets</code> which will contain the extension assets.</p>

<p>Now go to the <a href="http://prismjs.com/download.html">Prism download page</a>, generate the wanted configuration, and download provided code. Save JavaScript code as <code>prism.js</code> in <code>assets</code> folder, and CSS code as <code>prism.css</code> in the same folder.</p>

<p>To use the downloaded assets you will need to add the code to <code>run()</code> method.</p>

<p>First you want to <a href="http://www.yiiframework.com/doc/api/1.1/CAssetManager/#publish-detail">publish your assets</a> to a web accessible directory:</p>

<figure class='code'><figcaption><span>Publish assets to a web accessible directory</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$assets</span> <span class="o">=</span> <span class="nx">Yii</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getAssetManager</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">publish</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/assets&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Also get <em>ClientScript</em> component to help you with registering your assets:</p>

<figure class='code'><figcaption><span>Get & assign ClientScript component to a variable</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$cs</span> <span class="o">=</span> <span class="nx">Yii</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getClientScript</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>Because <em>Prism</em> only needs the asset files added to page for it to run, all that is left is to register the assets:</p>

<figure class='code'><figcaption><span>Register assets to the page</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerCssFile</span><span class="p">(</span><span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.css&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerScriptFile</span><span class="p">(</span><span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.js&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <a href="http://www.yiiframework.com/doc/api/1.1/CClientScript/#registerCssFile-detail"><code>registerCssFile()</code></a> and <a href="http://www.yiiframework.com/doc/api/1.1/CClientScript/#registerScriptFile-detail"><code>registerScriptFile()</code></a> adds the CSS and JavaScript files to the rendered page. If you needed to run some JavaScript code to run the plugin then you will need to add a call to <a href="http://www.yiiframework.com/doc/api/1.1/CClientScript/#registerScript-detail"><code>registerScript()</code></a> method which will add your JavaScript code to the page.</p>

<p>And this is it. You only need this much code to create a simple Yii extension. But of course it can be improved so continue reading if you want to get some ideas how to improve your extensions after having the minimal needed code.</p>

<h4>Step results</h4>

<p>By now your folder structure should be:</p>

<figure class='code'><figcaption><span>Folder structure after second step (minimal working extension)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>EPrism/
</span><span class='line'>├── EPrism.php
</span><span class='line'>└── assets
</span><span class='line'>    ├── prism.css
</span><span class='line'>    └── prism.js
</span></code></pre></td></tr></table></div></figure>


<p>The contents of <code>EPrism.php</code> file should be:</p>

<figure class='code'><figcaption><span>Extension contents after second step (minimal working extension)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">EPrism</span> <span class="k">extends</span> <span class="nx">CWidget</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">init</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="nv">$assets</span> <span class="o">=</span> <span class="nx">Yii</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getAssetManager</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">publish</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/assets&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="nv">$cs</span> <span class="o">=</span> <span class="nx">Yii</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getClientScript</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerCssFile</span><span class="p">(</span><span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.css&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerScriptFile</span><span class="p">(</span><span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.js&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>3. Add customizations for script</h2>

<p>The extension currently does what it&rsquo;s supposed to do, but how about adding a couple of customizations like allowing to change the position of where script is inserted and disabling automatic highlighting.</p>

<h3>Change script position</h3>

<p>First add the class variable which will tell where JavaScript files should be inserted:</p>

<figure class='code'><figcaption><span>Add variable to hold script position</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">public</span> <span class="nv">$scriptPosition</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then add the following code at the start of <code>init()</code> method:</p>

<figure class='code'><figcaption><span>Set to default position if none provided</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nb">is_null</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptPosition</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptPosition</span> <span class="o">=</span> <span class="nx">Yii</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">clientScript</span><span class="o">-&gt;</span><span class="na">defaultScriptFilePosition</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>It will make sure that if you don&rsquo;t set a custom script position for the extension, the default position for all script files will be used.</p>

<p>To finish it off just set the position then registering script file in <code>run()</code> method:</p>

<figure class='code'><figcaption><span>Set the position of script through second parameter</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerScriptFile</span><span class="p">(</span><span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.js&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptPosition</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now if for example you need to have some script loaded in the <code>&lt;head&gt;</code> element while your application is configured to add all scripts before closing <code>&lt;body&gt;</code> it is very simple to do in a widget configuration.</p>

<h3>Disable automatic highlighting</h3>

<p><em>Prism</em> automatically highlights the code in your page, but you can turn it off by adding <code>data-manual</code> attribute to the <code>&lt;script&gt;</code> element which loads the plugin.</p>

<p>You will need to add two variables, one for holding all the options for script and another as a flag for manual highlighting:</p>

<figure class='code'><figcaption><span>Add variables to allow script customization</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">private</span> <span class="nv">$scriptOptions</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="nv">$manualHighlight</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>$scriptOptions</code> variable is private because you don&rsquo;t want anyone changing it (the widget will populate it with needed values). To make sure it happens add the following code in the <code>init()</code> method before returning parent method:</p>

<figure class='code'><figcaption><span>Populate script options from public variables</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">manualHighlight</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptOptions</span><span class="p">[</span><span class="s1">&#39;data-manual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And then add options then registering your script file:</p>

<figure class='code'><figcaption><span>Customize registered script with 3rd parameter</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerScriptFile</span><span class="p">(</span>
</span><span class='line'>    <span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.js&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptPosition</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptOptions</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now you can disable the automatic highlighting when you call the widget just by setting <code>manualHighlight</code> attribute to <code>true</code>.</p>

<h3>Allow to use custom asset files</h3>

<p>To make extension re-usable and easy to use we added the JavaScript and CSS assets to it, but in some cases you might not want to use them. Maybe you only need to use a small portion of highlighter or maybe you have all the needed code in another file. To take care of those cases lets make asset files configurable using the following rules:</p>

<ul>
<li>If value is <code>false</code> don&rsquo;t register asset</li>
<li>If value is <code>null</code> register default asset</li>
<li>If value is <code>string</code> register the provided value</li>
</ul>


<p>To allow for this configuration first add the following class variables:</p>

<figure class='code'><figcaption><span>Add variables for asset files customization</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">public</span> <span class="nv">$cssFile</span>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="nv">$scriptFile</span>
</span></code></pre></td></tr></table></div></figure>


<p>And then change the asset registration lines with extended logic:</p>

<figure class='code'><figcaption><span>Extend the asset registration</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cssFile</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerCssFile</span><span class="p">(</span>
</span><span class='line'>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cssFile</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cssFile</span> <span class="o">:</span> <span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.css&#39;</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptFile</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerScriptFile</span><span class="p">(</span>
</span><span class='line'>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptFile</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptFile</span> <span class="o">:</span> <span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.js&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptPosition</span><span class="p">,</span>
</span><span class='line'>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptOptions</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This simple change allows you to be much more flexible with widget usage.</p>

<h4>Step results</h4>

<p>You folder structure hasn&rsquo;t changed so it will be the same as before.</p>

<p>The contents of <code>EPrism.php</code> file should be:</p>

<figure class='code'><figcaption><span>Extension contents with all improvements</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">EPrism</span> <span class="k">extends</span> <span class="nx">CWidget</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="nv">$scriptOptions</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nv">$manualHighlight</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nv">$scriptPosition</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nv">$cssFile</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nv">$scriptFile</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">init</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nb">is_null</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptPosition</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptPosition</span> <span class="o">=</span> <span class="nx">Yii</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">clientScript</span><span class="o">-&gt;</span><span class="na">defaultScriptFilePosition</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">manualHighlight</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptOptions</span><span class="p">[</span><span class="s1">&#39;data-manual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="nv">$assets</span> <span class="o">=</span> <span class="nx">Yii</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getAssetManager</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">publish</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/assets&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="nv">$cs</span> <span class="o">=</span> <span class="nx">Yii</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getClientScript</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cssFile</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerCssFile</span><span class="p">(</span>
</span><span class='line'>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cssFile</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cssFile</span> <span class="o">:</span> <span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.css&#39;</span>
</span><span class='line'>            <span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptFile</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nv">$cs</span><span class="o">-&gt;</span><span class="na">registerScriptFile</span><span class="p">(</span>
</span><span class='line'>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptFile</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptFile</span> <span class="o">:</span> <span class="nv">$assets</span> <span class="o">.</span> <span class="s1">&#39;/prism.js&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptPosition</span><span class="p">,</span>
</span><span class='line'>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">scriptOptions</span>
</span><span class='line'>            <span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Bonus points: Sharing is caring</h2>

<p>At this point you have a working, customizable extension which will kick ass in your project. But how about sharing it with your fellow programmers?</p>

<p>Simply add <strong>readme</strong> explaining how to use your extension and some comments in the code explaining what is what. Even if you&rsquo;re not going to share the extension with others, you will thank yourself later when the time comes to improve it. Include the <code>composer.json</code> file to make it possible to use your extension through <a href="https://getcomposer.org/">Composer</a> and just share it on <a href="https://github.com/">GitHub</a> or somewhere else for everyone to enjoy.</p>

<h2>Conclussion</h2>

<p>Now you can relax and take a well deserved cup of tea.</p>
</div>


  <footer>
    <ul class="social-buttons">
  <li>
    <a class="socialite twitter-share"
      href="https://twitter.com/share"
      data-via="ifdattic"
      data-count="vertical"
      rel="nofollow"
      target="_blank">
      Share on Twitter
    </a>
  </li>
  <li>
    <a class="socialite twitter-follow"
      href="https://twitter.com/ifdattic"
      data-count="vertical"
      target="_blank">
      Follow me
    </a>
  </li>
  <li>
    <a class="socialite googleplus-one"
    href="https://plus.google.com/share"
    data-size="tall"
    rel="nofollow"
    target="_blank">
      Share on Google+
    </a>
  </li>
  <li>
    <a class="socialite facebook-like"
      href="https://www.facebook.com/sharer.php"
      data-layout="box_count"
      data-width="60"
      data-show-faces="false"
      rel="nofollow"
      target="_blank">
      Share on Facebook
    </a>
  </li>
  <li>
    <a class="socialite linkedin-share"
      href="https://www.linkedin.com/shareArticle"
      data-counter="top"
      rel="nofollow"
      target="_blank">
      Share on LinkedIn
    </a>
  </li>
</ul>

    <p class="meta">
      <a href="https://github.com/ifdattic/ifdattic.github.io/blob/source/source/_posts/2014-03-05-create-yii-extension-by-example-eprism.markdown">Edit this page on GitHub</a><br />
      
  

<span class="byline author vcard">Posted by <span class="fn">Andrew Marcinkevičius</span></span>

      








  


<time datetime="2014-03-05T21:46:37+02:00" pubdate data-updated="true">March  5, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/categories/extensions/'>Extensions</a>, <a class='category' href='/categories/tutorials/'>Tutorials</a>, <a class='category' href='/categories/yii/'>Yii</a>
  
</span>


    </p>
    <p class="meta">
      
        <a class="basic-alignment left" href="/eprism-extension" title="Previous Post: EPrism Extension">&laquo; EPrism Extension</a>
      
      
        <a class="basic-alignment right" href="/how-to-scare-your-customers-away" title="Next Post: How to Scare Your Customers Away">How to Scare Your Customers Away &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

    </div>
  </div>
  <footer role="contentinfo"><div class="wrapper"><p>&copy; 2015 - Andrew Marcinkevičius</p>
<p>
  Hosted on <a href="https://github.com/ifdattic/ifdattic.github.io">Github</a>
  -
  Powered by <a href="http://octopress.org">Octopress</a>
</p>

</div></footer>
  

<script type="text/javascript">
      var disqus_shortname = 'ifdattic';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ifdattic.github.io/create-yii-extension-by-example-eprism';
        var disqus_url = 'http://ifdattic.github.io/create-yii-extension-by-example-eprism';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<script src="/javascripts/socialite.min.js"></script>
<script src="/javascripts/scripts.js" type="text/javascript"></script>


</body>
</html>
