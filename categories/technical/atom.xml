<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Technical | ifdattic]]></title>
  <link href="http://ifdattic.com/categories/technical/atom.xml" rel="self"/>
  <link href="http://ifdattic.com/"/>
  <updated>2015-06-24T07:35:17+02:00</updated>
  <id>http://ifdattic.com/</id>
  <author>
    <name><![CDATA[Andrew Marcinkevičius]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Configure phpspec for DDD]]></title>
    <link href="http://ifdattic.com/configure-phpspec-for-ddd"/>
    <updated>2015-06-24T07:16:35+02:00</updated>
    <id>http://ifdattic.com/configure-phpspec-for-ddd</id>
    <content type="html"><![CDATA[<p>A lot of my architecture for DDD is taken from <a href="http://programmingarehard.com/">David Adams</a>, <a href="http://verraes.net/">Mathias Verraes</a>, <a href="http://williamdurand.fr/">William Durand</a> &amp; other smart people.</p>

<p>While developing an application I try to keep the code separated. I also love testing and one wonderful tool which helps me produce good quality code is <a href="http://www.phpspec.net/">phpspec</a>. The issue is what by default it keeps all the tests in the root directory.</p>

<p>phpspec requires some configuration to keep the tests where they belong. You might notice that I&rsquo;m using Symfony framework for my application. When you do DDD development the framework used isn&rsquo;t that important. My domain login is kept in <code>src/Domain</code> directory &amp; infrastructure code is kept as bundles in <code>src</code> directory.</p>

<p>The following configuration is required to make phpspec work correctly (finding specs, creating/updating specs, running specs):</p>

<p>```yml
suites:</p>

<pre><code>core_suite:
    namespace: Domain\Core
    psr4_prefix: Domain\Core
    spec_path: src/Domain/Core
    src_path: src/Domain/Core
    spec_prefix: Spec

user_infrastructure_suite:
    namespace: UserBundle
    psr4_prefix: UserBundle
    spec_path: src/UserBundle
    src_path: src/UserBundle
    spec_prefix: Spec

user_suite:
    namespace: Domain\User
    psr4_prefix: Domain\User
    spec_path: src/Domain/User
    src_path: src/Domain/User
    spec_prefix: Spec
</code></pre>

<p>```</p>

<p>Save the file as <code>phpspec.yml</code> in root directory.</p>

<p><a href="https://www.flickr.com/photos/ifdattic/18485964273" title="Configure phpspec for DDD by Andrew Marcinkevičius, on Flickr"><img src="https://c4.staticflickr.com/4/3898/18485964273_ac0e4e5e5b_z.jpg" width="640" height="296" alt="Configure phpspec for DDD"></a></p>

<p>If you would run:</p>

<p><code>bash
phpspec describe Domain/User/ValueObject/UserName
</code></p>

<p>It should create a file <code>UserNameSpec.php</code> in <code>src/Domain/User/Spec/ValueObject</code>.</p>

<p>Some lines in suites might look like duplication, but I found that you have to set all the options. Otherwise there are issues with file creation/updating. You could skip <code>spec_prefix</code> option if you don&rsquo;t mind specifications directory in lowercase.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spy Test Double Using Prophecy]]></title>
    <link href="http://ifdattic.com/spy-test-double-using-prophecy"/>
    <updated>2015-05-20T12:47:25+02:00</updated>
    <id>http://ifdattic.com/spy-test-double-using-prophecy</id>
    <content type="html"><![CDATA[<p>Spy is a test double which records its actions. After code execution you can check if interaction is as expected. You use it to make sure the method(s) was called.</p>

<p>Below is the class which has an optional dependency which is called:</p>

<p>```php
&lt;?php</p>

<p>namespace App;</p>

<p>class Questioner
{</p>

<pre><code>private $output;
private $questions = [];
private $scorer;

public function __construct(OutputInterface $output, ScorerInterface $scorer = null)
{
    $this-&gt;output = $output;
    $this-&gt;scorer = $scorer;
}

/** @return int */
public function getQuestionsCount()
{
    return 0;
}

/**
 * Save under a new name.
 *
 * @param  string $name
 * @return boolean
 */
public function saveAs($name)
{
    $saved = $this-&gt;output-&gt;save($this-&gt;questions, $name);

    if ($saved &amp;&amp; $this-&gt;scorer) {
        $this-&gt;scorer-&gt;update();
    }

    return $saved;
}
</code></pre>

<p>}
```</p>

<p>To check that the <code>update()</code> method on <code>Scorer</code> is called use the following spy test double:</p>

<p>```php
&lt;?php</p>

<p>namespace tests;</p>

<p>use App\Output;
use App\Questioner;
use App\Scorer;
use Prophecy\Argument;</p>

<p>class QuestionerTest extends \PHPUnit_Framework_TestCase
{</p>

<pre><code>// ...

/**
 * @test
 */
function score_is_updated_on_save()
{
    $outputStub = $this-&gt;prophesize(Output::CLASS);
    $outputStub-&gt;save([], Argument::type('string'))-&gt;willReturn(true);
    $scorerSpy = $this-&gt;prophesize(Scorer::CLASS);
    $questioner = new Questioner($outputStub-&gt;reveal(), $scorerSpy-&gt;reveal());

    $questioner-&gt;saveAs('any name');

    $scorerSpy-&gt;update()-&gt;shouldHaveBeenCalled();
}
</code></pre>

<p>}
```</p>

<p>This article is from the **Test doubles using Prophecy** series which is made from following articles:

* [Dummy Test Double Using Prophecy](/dummy-test-double-using-prophecy)
* [Stub Test Double Using Prophecy](/stub-test-double-using-prophecy)
* [Spy Test Double Using Prophecy](/spy-test-double-using-prophecy)
</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Stub Test Double Using Prophecy]]></title>
    <link href="http://ifdattic.com/stub-test-double-using-prophecy"/>
    <updated>2015-04-23T08:11:17+02:00</updated>
    <id>http://ifdattic.com/stub-test-double-using-prophecy</id>
    <content type="html"><![CDATA[<p>Stub is the next simplest test double after the <a href="dummy-test-double-using-prophecy">Dummy</a>.</p>

<p>It doesn&rsquo;t have any expectations about the object behavior, but behaves in a specific way when put in a specific environment.</p>

<p>Below is the class under the test:</p>

<p>```php
&lt;?php</p>

<p>namespace App;</p>

<p>class Questioner
{</p>

<pre><code>private $output;
private $questions = [];

public function __construct(OutputInterface $output)
{
    $this-&gt;output = $output;
}

/** @return int */
public function getQuestionsCount()
{
    return 0;
}

/**
 * Save under a new name.
 *
 * @param  string $name
 * @return boolean
 */
public function saveAs($name)
{
    return $this-&gt;output-&gt;save($this-&gt;questions, $name);
}
</code></pre>

<p>}
```</p>

<p><code>saveAs</code> method can be tested by using a stub test double:</p>

<p>```php
&lt;?php</p>

<p>namespace tests;</p>

<p>use App\Output;
use App\Questioner;</p>

<p>class QuestionerTest extends \PHPUnit_Framework_TestCase
{</p>

<pre><code>/**
 * @test
 */
function new_questioner_has_no_questions()
{
    $outputDummy = $this-&gt;prophesize(Output::class);
    $questioner  = new Questioner($outputDummy-&gt;reveal());

    $this-&gt;assertSame(0, $questioner-&gt;getQuestionsCount());
}

/**
 * @test
 */
function questioner_is_saved_under_a_new_name()
{
    $outputStub = $this-&gt;prophesize(Output::class);
    $outputStub-&gt;save([], 'new name')-&gt;willReturn(true);
    $questioner = new Questioner($outputStub-&gt;reveal());

    $this-&gt;assertTrue($questioner-&gt;saveAs('new name'));
}
</code></pre>

<p>}
```</p>

<p>The test will pass as long as first parameter for <code>save</code> method is an empty array (<code>[]</code>) and the second parameter is <code>new name</code>. Prophecy allows you to use argument wildcards making your tests more durable. Below you can see a new test which allows any string for a name:</p>

<p>```php
&lt;?php</p>

<p>// &hellip;
use Prophecy\Argument;</p>

<p>class QuestionerTest extends \PHPUnit_Framework_TestCase
{</p>

<pre><code>// ...

/**
 * @test
 */
function questioner_is_saved_under_any_name()
{
    $outputStub = $this-&gt;prophesize(Output::class);
    $outputStub-&gt;save([], Argument::type('string'))-&gt;willReturn(true);
    $questioner = new Questioner($outputStub-&gt;reveal());

    $this-&gt;assertTrue($questioner-&gt;saveAs('any name'));
}
</code></pre>

<p>}
```</p>

<p>For the full list of arguments you can you check the code of <code>Prophecy\Argument</code> class. Here&rsquo;s some of them you might want to use in your tests:</p>

<ul>
<li><code>Argument::is($value)</code> checks that the argument is identical to a specific value</li>
<li><code>Argument::exact($value)</code> checks that the arguments matches a specific value</li>
<li><code>Argument::type($typeOrClass)</code> checks that the argument matches a specific type or class name</li>
<li><code>Argument::any()</code> matches any argument</li>
</ul>


<p>This article is from the **Test doubles using Prophecy** series which is made from following articles:

* [Dummy Test Double Using Prophecy](/dummy-test-double-using-prophecy)
* [Stub Test Double Using Prophecy](/stub-test-double-using-prophecy)
* [Spy Test Double Using Prophecy](/spy-test-double-using-prophecy)
</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Dummy Test Double Using Prophecy]]></title>
    <link href="http://ifdattic.com/dummy-test-double-using-prophecy"/>
    <updated>2015-03-19T15:23:51+01:00</updated>
    <id>http://ifdattic.com/dummy-test-double-using-prophecy</id>
    <content type="html"><![CDATA[<p>Dummy is the simplest test double.</p>

<p>It doesn&rsquo;t contain any logic and you use it when you need to satisfy a dependency which is not needed for functionality being tested.</p>

<p>Below is the class which has a constructor dependency:</p>

<p>```php
&lt;?php</p>

<p>namespace App;</p>

<p>class Questioner
{</p>

<pre><code>private $output;

public function __construct(OutputInterface $output)
{
    $this-&gt;output = $output;
}

public function getQuestionsCount()
{
    return 0;
}
</code></pre>

<p>}
```</p>

<p>The dependency can be satisfied by providing a dummy object:</p>

<p>```php
&lt;?php</p>

<p>namespace tests;</p>

<p>use App\Output;
use App\Questioner;</p>

<p>class QuestionerTest extends \PHPUnit_Framework_TestCase
{</p>

<pre><code>/**
 * @test
 */
function new_questioner_has_no_questions()
{
    $outputDummy = $this-&gt;prophesize(Output::class);
    $questioner  = new Questioner($outputDummy-&gt;reveal());

    $this-&gt;assertSame(0, $questioner-&gt;getQuestionsCount());
}
</code></pre>

<p>}
```</p>

<p>This article is from the **Test doubles using Prophecy** series which is made from following articles:

* [Dummy Test Double Using Prophecy](/dummy-test-double-using-prophecy)
* [Stub Test Double Using Prophecy](/stub-test-double-using-prophecy)
* [Spy Test Double Using Prophecy](/spy-test-double-using-prophecy)
</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[My experience with SensioLabs Symfony certification exam]]></title>
    <link href="http://ifdattic.com/my-experience-sensiolabs-symfony-certification-exam"/>
    <updated>2015-02-17T17:19:52+01:00</updated>
    <id>http://ifdattic.com/my-experience-with-sensiolabs-symfony-certification-exam</id>
    <content type="html"><![CDATA[<p>One day I check my email and see one from Fabien <em>&ldquo;Symfony turned 9 and for being one of top 100 contributors you get a free voucher.&rdquo;</em> It definitely lifted my spirits.</p>

<p>Voucher was valid for a year so I just created a calendar reminder <em>&ldquo;Learn for Symfony certificate.&rdquo;</em> Made it due sometime in Summer and more or less forgot about it. More than enough time left for it.</p>

<p>After the SymfonyCon Madrid I evaluated my career possibilities. Decided it&rsquo;s time to stop riding a dead horse and move the majority of my time working with Symfony framework. At the same time remembered the <a href="http://en.wikipedia.org/wiki/Parkinson%27s_law">Parkinson&rsquo;s Law</a>. <strong>The task will take as long as it&rsquo;s given time</strong>. Time to add the deadline. No matter how much I will learn for it, on March 1st I need to book the exam.</p>

<p>Somehow I made January &amp; February months for learning a lot of new things. Because of that I didn&rsquo;t get as much practical experience as suspected. Still <strong>made a habit of 90 minutes reading Symfony documentation for breakfast</strong>, um, tasty. This habit was mandatory!</p>

<p>The only preparation what I did was to take all the topics written in certification page and put them in a Trello card. Add items for cookbook topics, doctrine, etc. Not all are required for certification, but a good documentation is like a good book for me, so I didn&rsquo;t mind adding them. Add the links for easy access to as much of items as possible and that&rsquo;s it.</p>

<p>At first the list of about 160 items makes you take a big breath. But one check-box at a time you can see the progress.</p>

<p>This was also the <em>great chance to improve the documentation</em> (fixing typos, etc.). Changing it to the way you imagine it (changing formatting, etc.) and picking the brains of Symfony contributors (discussions in PRs, etc.).</p>

<p><em>90 minutes each day was spent making a few notes once in a while, creating pull requests, experimenting a bit</em>. On February I did some calculations and estimated that around the middle of it I should be done. It was time to register for an exam. Really wanted to do it on February 13th the Friday (how cool does that sound). But the place I like staying at wasn&rsquo;t available for rent. Also it felt like trying to avoid the unavoidable (a bad habit to have). So just registered for Monday (the sooner the better).</p>

<p>In the remaining days finished with the remaining topics. Did a <em>quick second round on the book</em> and it was time to take the exam the next day. <em>This took me about 6 weeks (~63 hours)</em>. I never believed about learning till the last second. My choice always is to put a good nights sleep between learning &amp; applying it. So Sunday documentation breakfast was the last one I will be taking for at least a while (<em>failure is always an option</em>).</p>

<p>The next day I woke up feeling great. Slept well, had a nice meeting the day before, exercised, took a shower, ate and the day looked like it will be a great one. Or would it? Nah, it would be a good one. The worst that could happen is that I won&rsquo;t pass the exam and that&rsquo;s it. It&rsquo;s not the end of a world.</p>

<p>OK, I worried a bit about slipping on the icy bridge while walking to the exam center and breaking my neck or dropping into a cold water. But this is the problem with my imagination. Other than that, I was trying to keep a relaxed attitude by taking a long slow walk along the snowed river to the exam center. Went out early to keep my paranoia in check about arriving late, <em>I like to stay safe</em>.</p>

<p>It sounds silly, but after arriving <em>I noticed my legs getting a bit weaker and heart pounding a little harder. Stupid body</em>. Had about half an hour before the exam. I always try to prepare myself for the worst scenario (which never happens) just in case. And you get a pleasant surprise when the end result is better than that you were expecting. If you&rsquo;re prepared to lose both legs, losing only one of them is wonderful. But most of the time from my research (books, articles, etc.) the suggestion is to imagine the result you want and your mind will go towards it. I&rsquo;m still skeptic about it, but if it&rsquo;s repeated often there must be something to it. And <em>you can&rsquo;t learn without testing</em>, so why not, let&rsquo;s try it.</p>

<p>I sat down. Closed my eyes. Started taking monotonic breaths and focusing my mind on passing the exam. At least my heart stopped pounding. A fresher head couldn&rsquo;t hurt either.</p>

<p><em>I&rsquo;m personally a little skeptic about these exams as you could pass them with a good memory</em>. Especially after I met a person with a Java certificate when he shouldn&rsquo;t be a programmer in the first place. Unfortunately for me, <em>I  don&rsquo;t have a good memory, and it works in strange ways</em>. For example, trying to remember when I had my first operation (string of 10 characters) leads to the following flow: it was on my birthday, I finished school that year, it was my 19th birthday, I finished school one year after 18th birthday, on my school leaving certificate it&rsquo;s written 2006, so I had it on 2006-06-28. Not the best way to remember a date. <em>Fortunately for me, my logic module pick up the pace and helps were memory starts ramble. I just have to put enough resources to be able to link them together.</em></p>

<p>By reminding myself that it wouldn&rsquo;t matter if I fail my head wasn&rsquo;t occupied by negative thoughts about that will happen if I fail. This allowed to take the exam with <em>stone cold focus. Read the question, read the answers, pick the one which is correct or makes most sense, keep going</em>. Flagged two questions for review, but after the second time told myself to stop doing that and simply believe in myself. <em>I enjoyed the exam a lot. It had a good flow &amp; presentation of questions</em>. A few of them made my head go &ldquo;What??&rdquo; (unlike Zend Certificate which contained quite a few &ldquo;WTF?!?&rdquo; questions). Solution to them was simple &ndash; read the question &amp; answers again, you can do this.</p>

<p>75 questions later was confirming that I&rsquo;m finishing the exam and the moment of truth&hellip; Thinking I did good on exam. Still, took the big breath guessing if I should just wait for screen to change or close my eyes&hellip; The screen is still waiting&hellip; The screen finishes loading&hellip; And a log-in pop-up shoots to the front of the screen&hellip;</p>

<p>(╯°□°）╯︵ ┻━┻</p>

<p>After some fiddling I bring the screen back. My eyes start shooting around the screen scanning for required information. &hellip; &ldquo;<strong>Passed</strong>.&rdquo; Great, which level? &hellip; &ldquo;<strong>Expert</strong>.&rdquo; Yes *fist pump*</p>

<p>Unlike with PHP certificate my reaction at the end of exam was much more &ldquo;professional.&rdquo; It still felt awesome!!!</p>

<p>Note: For anyone who is interested I made a <a href="https://trello.com/c/aHnP3WUI/1-learn-for-symfony-certification">Trello card</a> public.</p>
]]></content>
  </entry>
  
</feed>
